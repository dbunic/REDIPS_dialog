/*
Copyright (c) 2008-2011, www.redips.net  All rights reserved.
Code licensed under the BSD License: http://www.redips.net/license/
http://www.redips.net/javascript/dialog-box/
Version 1.7.0
Aug 1, 2012.
*/
var REDIPS=REDIPS||{};
REDIPS.dialog=function(){var d,g,e,q,l,s,i,j,r,f,h,p=0,o=0,n,t;s=function(){var a,b,c=!1,d;try{b=new XMLHttpRequest}catch(g){a=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];for(d=0;d<a.length&&!c;d++)try{c=!0,b=new ActiveXObject(a[d])}catch(e){}if(!c)throw Error("Unable to create XMLHttpRequest!");}return b};l=function(a,b,c){void 0===b&&(b="");void 0===c&&(c="");h.innerHTML='<div class="redips_dialog_titlebar"><span title="Close" onclick="REDIPS.dialog.hide(\'undefined\')">'+REDIPS.dialog.close_button+
'</span></div><table class="redips_dialog_tbl" cellpadding="0" cellspacing="0"><tr><td valign="center" height="'+o+'" width="'+p+'">'+a+'<div class="redips_dialog_buttons">'+b+c+"</div></td></tr></table>";f.style.display=h.style.display="block";e(REDIPS.dialog.op_low,5)};q=function(a){var b,a=a.split("|");b=a[2];b=void 0!==b?"','"+b:"";return'<input type="button" onclick="REDIPS.dialog.hide(\''+i(a[1])+i(b)+'\');" value="'+i(a[0])+'"/>'};d=function(a){var b,c;b=a.split(",");if(1===b.length)a='<div class="redips_dialog_imgc"><img src="'+
b[0]+'" height="'+(o-40)+'"/></div>';else{a='<div class="redips_dialog_imgc" style="width:'+(p-8)+'px"><table><tr>';for(c=0;c<b.length;c++)a+='<td><img src="'+b[c]+'" height="'+(o-40)+'"/></td>';a+="</tr></table></div>"}return a};g=function(){var a,b,c,d;if("number"===typeof window.innerWidth)a=window.innerWidth,b=window.innerHeight,c=window.pageXOffset,d=window.pageYOffset;else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))a=document.documentElement.clientWidth,
b=document.documentElement.clientHeight,c=document.documentElement.scrollLeft,d=document.documentElement.scrollTop,f.style.width=a+"px",f.style.height=b+"px";else if(document.body&&(document.body.clientWidth||document.body.clientHeight))a=document.body.clientWidth,b=document.body.clientHeight,c=document.body.scrollLeft,d=document.body.scrollTop;h.style.left=(a-p)/2+"px";h.style.top=(b-o)/2+"px";f.style.top=d+"px";f.style.left=c+"px"};e=function(a,b){f.style.opacity=a/100;f.style.filter="alpha(opacity="+
a+")";a+=b;if(REDIPS.dialog.op_low<=a&&a<=REDIPS.dialog.op_high)setTimeout(function(){e(a,b)},REDIPS.dialog.fade_speed);else if(REDIPS.dialog.op_low>a&&(f.style.display="none","undefined"!==n))window[n](t)};i=function(a){void 0!==a&&(a=a.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," "));return a};return{op_high:60,op_low:0,fade_speed:10,youtube:'<object width="640" height="390"><param name="movie" value="http://_youtube_?&version=2&fs=0&rel=0&iv_load_policy=3&color2=0x6A93D4"></param><param name="allowFullScreen" value="true"></param><param name="allowScriptAccess" value="always"></param><embed src="http://_youtube_?&version=2&fs=0&rel=0&iv_load_policy=3&color2=0x6A93D4" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="640" height="390"></embed></object>',
shown:!1,close_button:"\u2715",init:function(){h=document.createElement("div");h.setAttribute("id","redips_dialog");r=document.createElement("div");f=document.createElement("div");f.setAttribute("id","redips_dialog_shade");var a=document.getElementsByTagName("body")[0];a.appendChild(f);a.appendChild(h);REDIPS.event.add(window,"resize",g);REDIPS.event.add(window,"scroll",g);j=s()},show:function(a,b,c,e,f){var h="",i="",k,m="",n=m="";k="";REDIPS.dialog.shown=!0;p=a;o=b;g();a=/(\.jpg|\.jpeg|\.gif|\.png)$/i;
b=/(\.php|\.html|\.aspx)/i;k=/www\.youtube\.com/i;void 0!==e&&(h=q(e));void 0!==f&&(i=q(f));"html"===c?l(r.innerHTML,h,i):a.test(c)?(k=c.split("|"),1===k.length?m=d(k[0]):(m=d(k[1]),n="<div>"+k[0]+"</div>"),l(m+n,h,i)):b.test(c)?(j.open("GET",c,!0),j.onreadystatechange=function(){4===j.readyState&&(200===j.status?l(j.responseText):l("Error: ["+j.status+"] "+j.statusText))},j.send(null)):k.test(c)?(m=REDIPS.dialog.youtube.replace(/_youtube_/g,c),l(m)):l(m+("<div>"+c+"</div>"),h,i);REDIPS.dialog.myhandler_displayed()},
hide:function(a,b){!0===REDIPS.dialog.shown&&(REDIPS.dialog.shown=!1,n=a,t=b,e(REDIPS.dialog.op_high,-10),h.style.display="none",REDIPS.dialog.myhandler_closed())},html:function(a){r.innerHTML=a},myhandler_displayed:function(){},myhandler_closed:function(){}}}();
REDIPS.event||(REDIPS.event=function(){return{add:function(d,g,e){d.addEventListener?d.addEventListener(g,e,!1):d.attachEvent?d.attachEvent("on"+g,e):d["on"+g]=e},remove:function(d,g,e){d.removeEventListener?d.removeEventListener(g,e,!1):d.detachEvent?d.detachEvent("on"+g,e):d["on"+g]=null}}}());